┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                  MiniRT STRUCTURE                                   │
└─────────────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────────┐
                              │     t_scene      │
                              │ (Complete Scene) │
                              └──────────────────┘
                                       │
              ┌────────────────┬───────┼───────┬─────────────────┬──────────────────┐
              │                │       │       │                 │                  │
        ┌─────────┐    ┌──────────┐   │  ┌─────────┐    ┌──────────────┐    ┌─────────┐
        │t_ambient│    │ t_camera │   │  │t_light[]│    │  t_object*   │    │ t_vec3   │
        │         │    │          │   │  │         │    │  (linked     │    │background│
        │• ratio  │    │• position│   │  │• position│   │   list)      │    │• rgb     │
        │• color  │    │• forward │   │  │• color   │   │              │    └─────────┘
        └─────────┘    │• up      │   │  │• brightness   └──────────────┘
                       │• right   │   │  └─────────┘             │
                       │• fov     │   │                          │
                       │• aspect_ │   │  ┌─────────────┐         │
                       │  ratio   │   └─▶│light_count  │         │
                       └──────────┘      └─────────────┘         │
                                                                 │
                          ┌──────────────────────────────────────┘
                          │
                   ┌─────────────┐
                   │  t_object   │ ◄─┐ (next pointer creates
                   │             │   │  linked list of objects)
                   │• type       │───┘
                   │• data (union)│
                   │• next       │
                   └─────────────┘
                          │
              ┌───────────┼───────────┬───────────────┐
              │           │           │               │
        ┌───────────┐ ┌─────────┐ ┌─────────────┐ ┌─────────┐
        │ t_sphere  │ │ t_plane │ │ t_cylinder  │ │ t_cone  │
        │           │ │         │ │             │ │         │
        │• center   │ │• point  │ │• center     │ │• apex   │
        │• radius   │ │• normal │ │• axis       │ │• axis   │
        │• material │ │• material││• radius     │ │• angle  │
        └───────────┘ └─────────┘ │• height     │ │• height │
              │           │       │• material   │ │• material│
              │           │       └─────────────┘ └─────────┘
              │           │             │               │
              └───────────┼─────────────┼───────────────┘
                          │             │
                    ┌─────────────────────────┐
                    │      t_material         │
                    │   (Surface Properties)  │
                    ├─────────────────────────┤
                    │ • color (t_vec3)        │
                    │   - x (red)             │
                    │   - y (green)           │
                    │   - z (blue)            │
                    │                         │
                    │ PHONG LIGHTING MODEL:   │
                    │ • ambient [0-1]         │ 
                    │ • diffuse [0-1]         │
                    │ • specular [0-1]        │ 
                    │ • shininess             │ 
                    │                         │
                    │ PATTERN SYSTEM (BONUS): │
                    │ • pattern_type          │ 
                    │   - PATTERN_SOLID       │    
                    │   - PATTERN_CHECKERBOARD│
                    │   - PATTERN_STRIPES     │
                    │ • pattern_color2        │
                    │ • pattern_scale         │ 
                    │ • bump (bool)           │ 
                    └─────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              RAY-OBJECT INTERSECTION                                │
└─────────────────────────────────────────────────────────────────────────────────────┘

    ┌─────────┐      ┌──────────────┐      ┌─────────────┐
    │  t_ray  │─────▶│ intersect_   │─────▶│   t_hit     │
    │         │      │ object()     │      │             │
    │• origin │      │              │      │• hit (bool) │
    │• direction│    │• sphere      │     │• t (distance)│
    │• t_min   │     │• plane       │      │• point      │
    │• t_max   │     │• cylinder    │      │• normal     │
    └─────────┘      │• cone        │      │• material*  │◄─┐
                     └──────────────┘      │• object*    │  │
                                          └─────────────┘   │
                                                            │
                                    Points back to the ───——┘
                                    material of the 
                                    intersected object



┌─────────────────────────────────────┐
│        START render_scene           │
│    (minirt structure passed in)     │
└─────────────────┬───────────────────┘
                  │
                  ▼
┌─────────────────────────────────────┐
│         Initialize y = 0            │
└─────────────────┬───────────────────┘
                  │
                  ▼
┌─────────────────────────────────────┐
│        y < minirt->height?          │◄──────────┐
└─────────────┬───────────────────────┘           │
              │ YES                               │
              ▼                                   │
┌─────────────────────────────────────┐           │
│         Initialize x = 0            │           │
└─────────────────┬───────────────────┘           │
                  │                               │
                  ▼                               │
┌─────────────────────────────────────┐           │
│        x < minirt->width?           │◄────────┐ │
└─────────────┬───────────────────────┘         │ │
              │ YES                             │ │
              ▼                                 │ │
┌─────────────────────────────────────┐         │ │
│  Generate ray from camera through   │         │ │
│  pixel (x,y) using generate_ray()   │         │ │
└─────────────────┬───────────────────┘         │ │
                  │                             │ │
                  ▼                             │ │
┌─────────────────────────────────────┐         │ │
│   Find closest intersection with     │         │ │
│   all objects using intersect_scene()│         │ │
└─────────────────┬───────────────────┘         │ │
                  │                             │ │
                  ▼                             │ │
┌─────────────────────────────────────┐         │ │
│         hit.hit == true?            │         │ │
└─────────┬───────────────┬───────────┘         │ │
          │ YES           │ NO                  │ │
          ▼               ▼                     │ │
┌───────────────┐  ┌─────────────────┐         │ │
│    SHADING    │  │ Use background  │         │ │
│   PIPELINE    │  │ color (black)   │         │ │
└───────┬───────┘  └─────────┬───────┘         │ │
        │                    │                 │ │
        ▼                    │                 │ │
┌─────────────────┐          │                 │ │
│ Initialize      │          │                 │ │
│ final_color = 0 │          │                 │ │
└─────┬───────────┘          │                 │ │
      │                      │                 │ │
      ▼                      │                 │ │
┌─────────────────┐          │                 │ │
│ AMBIENT         │          │                 │ │
│ LIGHTING        │          │                 │ │
│ final_color +=  │          │                 │ │
│ ambient_ratio * │          │                 │ │
│ material.color  │          │                 │ │
└─────┬───────────┘          │                 │ │
      │                      │                 │ │
      ▼                      │                 │ │
┌─────────────────┐          │                 │ │
│ For each light  │          │                 │ │
│ in scene.lights │◄─────┐   │                 │ │
└─────┬───────────┘      │   │                 │ │
      │                  │   │                 │ │
      ▼                  │   │                 │ │
┌─────────────────┐      │   │                 │ │
│ Calculate light │      │   │                 │ │
│ direction from  │      │   │                 │ │
│ hit.point to    │      │   │                 │ │
│ light.position  │      │   │                 │ │
└─────┬───────────┘      │   │                 │ │
      │                  │   │                 │ │
      ▼                  │   │                 │ │
┌─────────────────┐      │   │                 │ │
│ SHADOW TEST     │      │   │                 │ │
│ Cast shadow ray │      │   │                 │ │
│ from hit.point  │      │   │                 │ │
│ to light        │      │   │                 │ │
└─────┬───────────┘      │   │                 │ │
      │                  │   │                 │ │
      ▼                  │   │                 │ │
┌─────────────────┐      │   │                 │ │
│ Shadow ray hits │      │   │                 │ │
│ object before   │      │   │                 │ │
│ reaching light? │      │   │                 │ │
└─────┬─────┬─────┘      │   │                 │ │
      │YES  │NO          │   │                 │ │
      ▼     ▼            │   │                 │ │
┌─────────┐ ┌──────────┐ │   │                 │ │
│ Skip    │ │ DIFFUSE  │ │   │                 │ │
│ this    │ │ LIGHTING │ │   │                 │ │
│ light   │ │ Calculate│ │   │                 │ │
└─────┬───┘ │ Lambert  │ │   │                 │ │
      │     │ cosine   │ │   │                 │ │
      │     │ law      │ │   │                 │ │
      │     └─────┬────┘ │   │                 │ │
      │           ▼      │   │                 │ │
      │     ┌──────────┐ │   │                 │ │
      │     │ SPECULAR │ │   │                 │ │
      │     │ LIGHTING │ │   │                 │ │
      │     │ Calculate│ │   │                 │ │
      │     │ Phong    │ │   │                 │ │
      │     │ specular │ │   │                 │ │
      │     │ highlight│ │   │                 │ │
      │     └─────┬────┘ │   │                 │ │
      │           ▼      │   │                 │ │
      │     ┌──────────┐ │   │                 │ │
      │     │ Add      │ │   │                 │ │
      │     │ diffuse +│ │   │                 │ │
      │     │ specular │ │   │                 │ │
      │     │ to       │ │   │                 │ │
      │     │final_color│   │                 │ │
      │     └─────┬────┘ │   │                 │ │
      │           │      │   │                 │ │
      └───────────┼──────┘   │                 │ │
                  │          │                 │ │
                  ▼          │                 │ │
            ┌──────────┐     │                 │ │
            │ More     │     │                 │ │
            │ lights?  │─────┘                 │ │
            └─────┬────┘                       │ │
                  │ NO                         │ │
                  ▼                            │ │
            ┌──────────┐                       │ │
            │ MATERIAL │                       │ │
            │ EFFECTS  │                       │ │
            │ Apply    │                       │ │
            │ patterns,│                       │ │
            │ bump     │                       │ │
            │ mapping  │                       │ │
            └─────┬────┘                       │ │
                  │                            │ │
                  ▼                            │ │
            ┌──────────┐                       │ │
            │ Clamp    │                       │ │
            │ color    │                       │ │
            │ values   │                       │ │
            │ to 0-255 │                       │ │
            └─────┬────┘                       │ │
                  │                            │ │
                  └──────────┬─────────────────┘ │
                             │                   │
                             ▼                   │ │
                  ┌─────────────────────────────────┐ │
                  │ Convert t_vec3 color to RGB int │ │
                  │        using rgb_to_int()       │ │
                  └─────────────────┬───────────────┘ │
                                    │                 │ │
                                    ▼                 │ │
                  ┌─────────────────────────────────┐ │ │
                  │    Draw pixel at (x,y) with     │ │ │
                  │     color using put_pixel()     │ │ │
                  └─────────────────┬───────────────┘ │ │
                                    │                 │ │
                                    ▼                 │ │
                  ┌─────────────────────────────────┐ │ │
                  │           x = x + 1             │ │ │
                  └─────────────────┬───────────────┘ │ │
                                    │                 │ │
                                    └─────────────────┘ │
                                                        │
                    ┌───────────────────────────────────┘
                    │ NO (x >= width)
                    ▼
┌─────────────────────────────────────┐
│           y = y + 1                 │
└─────────────────┬───────────────────┘
                  │
                  └─────────────────────────────┘
                                                │
                  ┌─────────────────────────────┘
                  │ NO (y >= height)
                  ▼
┌─────────────────────────────────────┐
│              END                    │
│        (Final image complete)       │
└─────────────────────────────────────┘




